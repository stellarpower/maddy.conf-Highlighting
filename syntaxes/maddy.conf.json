{
  "name": "Maddy Configuration",
  "scopeName": "source.maddy-conf",
  "fileTypes": ["maddy"],
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#blocks"
    },
    {
      "include": "#macros"
    },
    {
      "include": "#macro_definitions"
    },
    {
      "include": "#references"
    },
    {
      "include": "#keywords"
    },
    {
      "include": "#literals"
    }
  ],
  "repository": {
    "comments": {
      "match": "#.*$",
      "name": "comment.line.number-sign.maddy-conf"
    },
    "strings": {
      "begin": "\"",
      "end": "\"",
      "name": "string.quoted.double.maddy-conf",
      "patterns": [
        {
          "match": "\\\\.",
          "name": "constant.character.escape.maddy-conf"
        }
      ]
    },
    "blocks": {
      "begin": "{",
      "end": "}",
      "patterns": [
        {
          "include": "$self"
        }
      ]
    },
    "macros": {
      "match": "(\\$\\()([a-z0-9_]+)(\\))",
      "captures": {
        "1": {"name": "punctuation.definition.macro.begin.maddy-conf"},
        "2": {"name": "entity.name.function.macro.maddy-conf"},
        "3": {"name": "punctuation.definition.macro.end.maddy-conf"}
      }
    },
    "macro_definitions": {
      "match": "(\\^\\$\\()([a-z0-9_]+)(\\))(\\s*)(=)(\\s*)(.*)",
      "captures": {
        "1": {"name": "punctuation.definition.macro.begin.maddy-conf"},
        "2": {"name": "entity.name.function.macro.maddy-conf"},
        "3": {"name": "punctuation.definition.macro.end.maddy-conf"},
        "5": {"name": "keyword.operator.assignment.maddy-conf"},
        "7": {"name": "string.unquoted.maddy-conf"}
      }
    },
    "references": {
      "match": "(\\&)([^ \\t\\n]+)",
      "captures": {
        "1": {"name": "punctuation.definition.reference.maddy-conf"},
        "2": {"name": "variable.other.reference.maddy-conf"}
      }
    },
    "literals": {
      "patterns": [
        {
          "match": "\\b(yes|no)\\b",
          "name": "constant.language.boolean.maddy-conf"
        },
        {
          "match": "\\b[-+]?\\d+\\.\\d*\\b",
          "name": "constant.numeric.float.maddy-conf"
        },
        {
          "match": "\\b[-+]?\\d+\\b",
          "name": "constant.numeric.integer.maddy-conf"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "match": "\\b(checks|command|dane|dkim|dnsbl|dnssec|dummy|extauth|external|file|identity|imap|imap_filters|imapsql|limits|lmtp|loader|local_policy|milter|modifiers|msgpipeline|mtasts|mx_auth|pam|pass_table|plain_separate|queue|regexp|remote|replace_rcpt|replace_sender|require_matching_rdns|require_mx_record|require_tls|rspamd|shadow|smtp|sql_query|sql_table|static|submission)\\b",
          "name": "keyword.other.module.maddy-conf"
        },
        {
          "match": "\\b(check|modify|default_source|source|default_destination|destination|reject|deliver_to|reroute|dmarc)\\b",
          "name": "keyword.other.dispatch.maddy-conf"
        },
        {
          "match": "\\b(add|add_header_action|allow_multiple_from|api_path|appendlimit|attempt_starttls|auth|autogenerated_msg_domain|body_canon|bounce|broken_sig_action|buffer|cache|case_insensitive|certs|check_early|client_ipv4|client_ipv6|compression|conn_max_idle_count|conn_max_idle_time|conn_reuse_limit|debug|defer_sender_reject|del|domains|driver|dsn|ehlo|endpoint|enforce_early|enforce_testing|entry|error_resp_action|expand_replaceholders|fail_action|fail_open|file|flags|force_ipv4|fs_dir|fsstore|full_match|hash|header_canon|helper|hostname|imap_filter|init|insecure_auth|io_debug|io_error_action|io_errors|junk_mailbox|key_column|key_path|keys|limits|list|local_ip|location|lookup|mailfrom|max_logged_rcpt_errors|max_message_size|max_parallelism|max_received|max_recipients|max_tries|min_mx_level|min_tls_level|mx_auth|neutral_action|newkey_algo|none_action|no_sig_action|oversign_fields|pass|perdomain|permerr_action|quarantine_threshold|read_timeout|reject_threshold|relaxed_requiretls|required_fields|require_sender_match|require_tls|requiretls_override|responses|rewrite_subj_action|run_on|score|selector|set|settings_id|sig_expiry|sign_fields|sign_subdomains|softfail_action|SOME_action|source|sqlite3_busy_timeout|sqlite3_cache_size|sqlite3_exclusive_lock|storage|table|table_name|tag|target|targets|temperr_action|tls|tls_client|use_helper|user|value_column|write_timeout)\\b",
          "name": "keyword.other.directive.maddy-conf"
        }
      ]
    }
  }
}